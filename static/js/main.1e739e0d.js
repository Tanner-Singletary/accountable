(()=>{"use strict";var e={8097:(e,t,r)=>{r.r(t),r.d(t,{default:()=>F});var n=r(885),i=r(3426),a=r(6792),o=r(9385),s=(r(5682),r(5004)),l=r(519),u=(0,r(1218).createClient)("https://bxfruloupumcvynxnqnt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4ZnJ1bG91cHVtY3Z5bnhucW50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTgwMTUyNzIsImV4cCI6MjAxMzU5MTI3Mn0.m6EPHp4wxq7GdWTJjjrdDQaD8uH2oWRWr1Sas4cwq1k",{auth:{storage:l.default,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),c=r(5861),d=r(3624),f=r(5898),m=r(2629);function h(){var e=(0,s.useState)(""),t=(0,n.default)(e,2),r=t[0],i=t[1],a=(0,s.useState)(""),l=(0,n.default)(a,2),h=l[0],p=l[1],g=(0,s.useState)(!1),x=(0,n.default)(g,2),v=x[0],j=x[1];function S(){return(S=(0,c.default)((function*(){j(!0);var e=(yield u.auth.signInWithPassword({email:r,password:h})).error;e&&d.default.alert(e.message),j(!1)}))).apply(this,arguments)}function b(){return(b=(0,c.default)((function*(){j(!0);var e=(yield u.auth.signUp({email:r,password:h})).error;e&&d.default.alert(e.message),j(!1)}))).apply(this,arguments)}return(0,m.jsxs)(o.default,{style:y.container,children:[(0,m.jsx)(o.default,{style:[y.verticallySpaced,y.mt20],children:(0,m.jsx)(f.Input,{label:"Email",leftIcon:{type:"font-awesome",name:"envelope"},onChangeText:function(e){return i(e)},value:r,placeholder:"email@address.com",autoCapitalize:"none"})}),(0,m.jsx)(o.default,{style:y.verticallySpaced,children:(0,m.jsx)(f.Input,{label:"Password",leftIcon:{type:"font-awesome",name:"lock"},onChangeText:function(e){return p(e)},value:h,secureTextEntry:!0,placeholder:"Password",autoCapitalize:"none"})}),(0,m.jsx)(o.default,{style:[y.verticallySpaced,y.mt20],children:(0,m.jsx)(f.Button,{title:"Sign in",disabled:v,onPress:function(){return function(){return S.apply(this,arguments)}()}})}),(0,m.jsx)(o.default,{style:y.verticallySpaced,children:(0,m.jsx)(f.Button,{title:"Sign up",disabled:v,onPress:function(){return function(){return b.apply(this,arguments)}()}})})]})}var y=a.default.create({container:{marginTop:40,padding:12},verticallySpaced:{paddingTop:4,paddingBottom:4,alignSelf:"stretch"},mt20:{marginTop:20}}),p=r(1054),g=r(3693),x=r(3645),v={colors:{background:"#F6F6F6",foreground:"#202121",primary:"#FFFFFFFF",veryGood:"#53C623",good:"#BDEDA8",veryBad:"#FF5733",bad:"#EDB9A8"},spacing:{s:8,m:16,l:24},textVariants:{header:{fontSize:36,fontWeight:"bold"},body:{fontSize:16}}};const j="web"===r(2152).default.OS?function(e,t,r,n){if(window.confirm([e,t].filter(Boolean).join("\n"))){var i=r.find((function(e){return"cancel"!==e.style}));i&&i.onPress()}else{var a=r.find((function(e){return"cancel"===e.style}));a&&a.onPress()}}:d.default.alert;function S(e){var t=(0,s.useState)(!1),r=(0,n.default)(t,2),i=r[0],a=r[1],l=(0,s.useState)(Boolean(e.metric.todayCount)),d=(0,n.default)(l,2),f=d[0],h=d[1],y=(0,s.useState)(e.metric.todayCount),x=(0,n.default)(y,2),S=x[0],b=x[1],C=(0,s.useState)(e.metric.lifetimeCount),w=(0,n.default)(C,2),_=w[0],P=w[1];function I(){return(I=(0,c.default)((function*(){h(!0),b(S+1),P(_+1);var t=e.colorHex===v.colors.veryBad?-1:1;e.updateScore(t);try{a(!0);var r={user_id:e.session.user.id,metric_id:e.metric.id},n=(yield u.from("metric_logs").insert(r)).error;if(n)throw n}catch(n){n instanceof Error&&j(n.message)}finally{a(!1)}}))).apply(this,arguments)}return(0,m.jsxs)(o.default,{style:{flex:1,alignItems:"center",justifyContent:"center",margin:10,backgroundColor:f?e.colorHex:e.initialColorHex,borderColor:"black",borderWidth:1},children:[(0,m.jsx)(g.default,{title:e.metric.name,onPress:function(){return function(){return I.apply(this,arguments)}()},disabled:i}),(0,m.jsxs)(p.default,{children:["Lifetime: ",_]}),(0,m.jsxs)(p.default,{children:["Today: ",S]})]})}function b(e){var t=e.colorHex===v.colors.veryBad?"Don't":"Do";return(0,m.jsxs)(o.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:[(0,m.jsx)(p.default,{style:{fontSize:18,fontWeight:"bold"},children:t}),(0,m.jsx)(x.default,{style:{backgroundColor:e.initialColorHex},data:e.metrics,renderItem:function(t){var r=t.item;return(0,m.jsx)(S,{metric:r,initialColorHex:e.initialColorHex,colorHex:e.colorHex,updateScore:e.updateScore,session:e.session})}})]})}function C(e){return(0,m.jsxs)(o.default,{style:{flex:1,marginTop:10,alignItems:"center",justifyContent:"center"},children:[(0,m.jsxs)(p.default,{children:["Lifetime Score: ",e.lifetimeScore]}),(0,m.jsxs)(p.default,{children:["Today's Score: ",e.todayScore]}),e.metrics.length>0?(0,m.jsxs)(o.default,{style:{flex:1,flexDirection:"row",padding:10,alignItems:"center",justifyContent:"center"},children:[(0,m.jsx)(b,{initialColorHex:v.colors.good,colorHex:v.colors.veryGood,metrics:e.metrics.filter((function(e){return"positive"===e.category})),updateScore:e.updateScore,session:e.session}),(0,m.jsx)(b,{initialColorHex:v.colors.bad,colorHex:v.colors.veryBad,metrics:e.metrics.filter((function(e){return"negative"===e.category})),updateScore:e.updateScore,session:e.session})]}):(0,m.jsx)(p.default,{style:{fontSize:20},children:"Click 'Add Metrics' below to get started! "}),(0,m.jsx)(p.default,{children:"\n"})]})}var w=r(6591);function _(e){var t=e.session,r=(0,s.useState)(!1),i=(0,n.default)(r,2),a=i[0],l=i[1],d=(0,s.useState)("New positive metric"),f=(0,n.default)(d,2),h=f[0],y=f[1],x=(0,s.useState)(""),v=(0,n.default)(x,2),S=v[0],b=v[1],C=(0,s.useState)("New negative metric"),_=(0,n.default)(C,2),I=_[0],O=_[1],k=(0,s.useState)(""),T=(0,n.default)(k,2),H=T[0],D=T[1];function F(e,t){return A.apply(this,arguments)}function A(){return(A=(0,c.default)((function*(e,r){try{console.log("async insertMetric called with:"),console.log({name:e,category:r}),l(!0);var n={user:t.user.id,name:e,category:r},i=(yield u.from("metrics").insert(n)).error;if(i)throw i}catch(i){i instanceof Error&&j(i.message)}finally{l(!1)}}))).apply(this,arguments)}return(0,m.jsxs)(o.default,{children:[(0,m.jsx)(w.default,{style:P.input,onChangeText:y,value:h}),(0,m.jsx)(g.default,{title:"Add positive metric",onPress:function(){return function(e){b(e),F(e,"positive")}(h)},disabled:a}),(0,m.jsx)(p.default,{children:S?`added ${S}!`:""}),(0,m.jsx)(p.default,{children:"\n\n"}),(0,m.jsx)(w.default,{style:P.input,onChangeText:O,value:I}),(0,m.jsx)(g.default,{title:"Add negative metric",onPress:function(){return function(e){D(e),F(e,"negative")}(I)},disabled:a}),(0,m.jsx)(p.default,{children:H?`added ${H}!`:""}),(0,m.jsx)(p.default,{children:"\n\n"})]})}var P=a.default.create({input:{height:40,margin:12,borderWidth:1,padding:10}}),I=r(2982),O=r(5087);function k(e){var t=(0,s.useState)(e.metrics),r=(0,n.default)(t,2),i=r[0],a=r[1],l=(0,s.useState)(!0),d=(0,n.default)(l,2),f=d[0],h=d[1];function y(){return(y=(0,c.default)((function*(){var t=i.filter((function(e){return!0===e.staged_to_delete})).map((function(e){return e.name}));(yield u.from("metrics").delete().eq("user",e.session.user.id).in("name",t)).error;j("Deletion submitted, return to home page to see remaining metrics."),e.setActivePage("home")}))).apply(this,arguments)}return(0,m.jsxs)(o.default,{style:{flex:1,padding:20,justifyContent:"center",alignItems:"center"},children:[(0,m.jsx)(p.default,{style:{fontSize:18,fontWeight:"bold"},children:"Delete Metrics"}),(0,m.jsx)(p.default,{children:"\n"}),(0,m.jsx)(x.default,{data:i,renderItem:function(e){var t=e.item;return(0,m.jsxs)(o.default,{style:{flex:1,flexDirection:"row",padding:10},children:[(0,m.jsx)(O.default,{trackColor:{false:"#767577",true:"#81b0ff"},thumbColor:t.a?"#f5dd4b":"#f4f3f4",ios_backgroundColor:"#3e3e3e",onValueChange:function(){return function(e){var t=(0,I.default)(i);for(var r of t)r.name===e.name&&(r.staged_to_delete=!r.staged_to_delete);h(t.filter((function(e){return!0===e.staged_to_delete})).length<=0),a(t)}(t)},value:t.staged_to_delete}),(0,m.jsx)(p.default,{style:{padding:10},children:t.name})]})}}),(0,m.jsx)(g.default,{title:"Delete",onPress:function(){return j("Delete all selected?","Press OK to permanently delete metrics.",[{text:"Cancel",onPress:function(){return console.log("Cancel Pressed")},style:"cancel"},{text:"OK",onPress:function(){return function(){return y.apply(this,arguments)}()}}])},disabled:f})]})}function T(e){var t=(0,m.jsx)(m.Fragment,{});switch(e.metrics.forEach((function(t){t.staged_to_delete=!1,t.lifetimeCount=e.metricLogs.filter((function(e){return e.metric_id===t.id})).length,t.todayCount=e.todayLogs.filter((function(e){return e.metric_id===t.id})).length})),e.activePage){case"home":t=(0,m.jsx)(C,{lifetimeScore:e.lifetimeScore,todayScore:e.todayScore,updateScore:e.updateScore,metrics:e.metrics,session:e.session});break;case"add_metrics":t=(0,m.jsx)(_,{session:e.session});break;case"delete_metrics":t=(0,m.jsx)(k,{session:e.session,metrics:e.metrics,setActivePage:e.setActivePage})}return(0,m.jsxs)(o.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:[t,(0,m.jsx)(g.default,{title:"Home",onPress:function(){return e.setActivePage("home")}}),(0,m.jsx)(g.default,{title:"Add Metrics",onPress:function(){return e.setActivePage("add_metrics")}}),(0,m.jsx)(g.default,{title:"Delete Metrics",onPress:function(){return e.setActivePage("delete_metrics")}})]})}function H(e){var t=e.session,r=(0,s.useState)(0),i=(0,n.default)(r,2),a=i[0],o=i[1],l=(0,s.useState)(0),d=(0,n.default)(l,2),f=d[0],h=d[1],y=(0,s.useState)("home"),g=(0,n.default)(y,2),x=g[0],v=g[1],S=(0,s.useState)(!1),b=(0,n.default)(S,2),C=b[0],w=b[1],_=(0,s.useState)(!1),P=(0,n.default)(_,2),I=P[0],O=P[1],k=(0,s.useState)([]),H=(0,n.default)(k,2),D=H[0],F=H[1],A=(0,s.useState)([]),E=(0,n.default)(A,2),M=E[0],z=E[1],B=(0,s.useState)([]),W=(0,n.default)(B,2),J=W[0],L=W[1];function q(){return(q=(0,c.default)((function*(){try{w(!0);var e=yield u.from("metrics").select("id,name,category").eq("user",t.user.id),r=e.data,n=e.error,i=e.status;if(n&&406!==i)throw n;r&&F(r)}catch(n){n instanceof Error&&j(n.message)}finally{w(!1)}}))).apply(this,arguments)}function G(){return(G=(0,c.default)((function*(){var e=new Date;e.setHours(0,0,0,0);var r=new Date;r.setHours(23,59,59,999);try{O(!0);var n=yield u.from("metric_logs").select("id,created_at,user_id,metric_id").eq("user_id",t.user.id),i=n.data,a=n.error,s=n.status;if(a&&406!==s)throw a;if(i){z(i),o(i.length);var l=i.filter((function(t){return new Date(t.created_at)>=e&&new Date(t.created_at)<=r}));L(l),h(J.length)}}catch(a){a instanceof Error&&j(a.message)}finally{O(!1)}}))).apply(this,arguments)}return(0,s.useEffect)((function(){!function(){q.apply(this,arguments)}(),function(){G.apply(this,arguments)}()}),[x]),C||I?(0,m.jsx)(p.default,{children:"Loading..."}):(0,m.jsx)(T,{lifetimeScore:a,todayScore:f,updateScore:function(e){h(f+e),o(a+e)},activePage:x,setActivePage:v,metrics:D,metricLogs:M,todayLogs:J,session:t})}function D(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(p.default,{style:{fontSize:20,fontWeight:"bold"},children:["Accountable","\n"]}),(0,m.jsxs)(p.default,{style:{fontSize:14},children:["The actions you take create the person you're becoming.","\n"]})]})}function F(){var e=(0,s.useState)(null),t=(0,n.default)(e,2),r=t[0],a=t[1];return(0,s.useEffect)((function(){u.auth.getSession().then((function(e){var t=e.data.session;a(t)})),u.auth.onAuthStateChange((function(e,t){a(t)}))}),[]),(0,m.jsxs)(o.default,{style:A.container,children:[(0,m.jsx)(D,{}),r&&r.user?(0,m.jsx)(H,{session:r},r.user.id):(0,m.jsx)(h,{}),(0,m.jsx)(i.default,{style:"auto"})]})}var A=a.default.create({container:{padding:30,flex:1,backgroundColor:v.colors.background,alignItems:"center",justifyContent:"center"}})}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,(()=>{var e=[];r.O=(t,n,i,a)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){for(var[n,i,a]=e[c],s=!0,l=0;l<n.length;l++)(!1&a||o>=a)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(s=!1,a<o&&(o=a));if(s){e.splice(c--,1);var u=i();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,i,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var a=Object.create(null);r.r(a);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>o[e]=()=>n[e]));return o.default=()=>n,r.d(a,o),a}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="/accountable/",(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,a,[o,s,l]=n,u=0;if(o.some((t=>0!==e[t]))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(l)var c=l(r)}for(t&&t(n);u<o.length;u++)a=o[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=r.O(void 0,[890],(()=>r(6271)));n=r.O(n)})();
//# sourceMappingURL=main.1e739e0d.js.map