(()=>{"use strict";var e={8097:(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var n=r(885),o=r(3426),a=r(6792),i=r(9385),l=(r(5682),r(5004)),s=r(5705),u=r(519),c=(0,r(1218).createClient)("https://bxfruloupumcvynxnqnt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4ZnJ1bG91cHVtY3Z5bnhucW50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTgwMTUyNzIsImV4cCI6MjAxMzU5MTI3Mn0.m6EPHp4wxq7GdWTJjjrdDQaD8uH2oWRWr1Sas4cwq1k",{auth:{storage:u.default,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),d=r(5861),f=r(3624),g=r(6850),m=r(2629);function p(){var e=(0,l.useState)(""),t=(0,n.default)(e,2),r=t[0],o=t[1],a=(0,l.useState)(""),s=(0,n.default)(a,2),u=s[0],p=s[1],y=(0,l.useState)(!1),x=(0,n.default)(y,2),j=x[0],v=x[1];function b(){return(b=(0,d.default)((function*(){v(!0);var e=(yield c.auth.signInWithPassword({email:r,password:u})).error;e&&f.default.alert(e.message),v(!1)}))).apply(this,arguments)}function S(){return(S=(0,d.default)((function*(){v(!0);var e=(yield c.auth.signUp({email:r,password:u})).error;e&&f.default.alert(e.message),v(!1)}))).apply(this,arguments)}return(0,m.jsxs)(i.default,{style:h.container,children:[(0,m.jsx)(i.default,{style:[h.verticallySpaced,h.mt20],children:(0,m.jsx)(g.Input,{label:"Email",leftIcon:{type:"font-awesome",name:"envelope"},onChangeText:function(e){return o(e)},value:r,placeholder:"email@address.com",autoCapitalize:"none"})}),(0,m.jsx)(i.default,{style:h.verticallySpaced,children:(0,m.jsx)(g.Input,{label:"Password",leftIcon:{type:"font-awesome",name:"lock"},onChangeText:function(e){return p(e)},value:u,secureTextEntry:!0,placeholder:"Password",autoCapitalize:"none"})}),(0,m.jsx)(i.default,{style:[h.verticallySpaced,h.mt20],children:(0,m.jsx)(g.Button,{title:"Sign in",disabled:j,onPress:function(){return function(){return b.apply(this,arguments)}()}})}),(0,m.jsx)(i.default,{style:h.verticallySpaced,children:(0,m.jsx)(g.Button,{title:"Sign up",disabled:j,onPress:function(){return function(){return S.apply(this,arguments)}()}})})]})}var h=a.default.create({container:{marginTop:40,padding:12},verticallySpaced:{paddingTop:4,paddingBottom:4,alignSelf:"stretch"},mt20:{marginTop:20}}),y=r(1054),x=r(3645),j={colors:{background:"#F6F6F6",foreground:"#202121",primary:"#FFFFFFFF",veryGood:"#53C623",good:"#BDEDA8",veryBad:"#FF5733",bad:"#EDB9A8"},spacing:{s:8,m:16,l:24},textVariants:{header:{fontSize:36,fontWeight:"bold"},body:{fontSize:16}}},v=r(3693);const b="web"===r(2152).default.OS?function(e,t,r,n){if(window.confirm([e,t].filter(Boolean).join("\n"))){var o=r.find((function(e){return"cancel"!==e.style}));o&&o.onPress()}else{var a=r.find((function(e){return"cancel"===e.style}));a&&a.onPress()}}:f.default.alert;function S(e){var t=(0,l.useState)(!1),r=(0,n.default)(t,2),o=r[0],a=r[1],s=(0,l.useState)(Boolean(e.metric.todayCount)),u=(0,n.default)(s,2),f=u[0],g=u[1],p=(0,l.useState)(e.metric.todayCount),h=(0,n.default)(p,2),x=h[0],S=h[1],C=(0,l.useState)(e.metric.lifetimeCount),w=(0,n.default)(C,2),I=w[0],_=w[1];function T(){return(T=(0,d.default)((function*(){g(!0),S(x+1),_(I+1);var t=e.colorHex===j.colors.veryBad?-1:1;try{a(!0);var r={user_id:e.session.user.id,metric_id:e.metric.id},n=(yield c.from("metric_logs").insert(r)).error;if(n)throw n}catch(n){n instanceof Error&&b(n.message)}finally{a(!1),e.updateScore(t)}}))).apply(this,arguments)}return(0,m.jsxs)(i.default,{style:{flex:1,alignItems:"center",justifyContent:"center",margin:10,backgroundColor:f?e.colorHex:e.initialColorHex,borderColor:"black",borderWidth:1},children:[(0,m.jsx)(v.default,{title:e.metric.name,onPress:function(){return function(){return T.apply(this,arguments)}()},disabled:o}),(0,m.jsxs)(y.default,{children:["Lifetime: ",I]}),(0,m.jsxs)(y.default,{children:["Today: ",x]})]})}function C(e){var t=e.colorHex===j.colors.veryBad?"Don't":"Do";return(0,m.jsxs)(i.default,{style:{flex:1,alignItems:"center",justifyContent:"center",overflowY:"auto",maxHeight:"100%"},children:[(0,m.jsx)(y.default,{style:{fontSize:18,fontWeight:"bold"},children:t}),(0,m.jsx)(x.default,{style:{backgroundColor:e.initialColorHex},data:e.metrics,renderItem:function(t){var r=t.item;return(0,m.jsx)(S,{metric:r,initialColorHex:e.initialColorHex,colorHex:e.colorHex,updateScore:e.updateScore,session:e.session})}})]})}function w(e){return(0,m.jsxs)(i.default,{style:{flex:1,marginTop:10,alignItems:"center",justifyContent:"center"},children:[(0,m.jsxs)(y.default,{children:["Lifetime Score: ",e.lifetimeScore]}),(0,m.jsxs)(y.default,{children:["Today's Score: ",e.todayScore]}),e.metrics.length>0?(0,m.jsxs)(i.default,{style:{flex:1,flexDirection:"row",padding:10,alignItems:"center",justifyContent:"center"},children:[(0,m.jsx)(C,{initialColorHex:j.colors.good,colorHex:j.colors.veryGood,metrics:e.metrics.filter((function(e){return"positive"===e.category})),updateScore:e.updateScore,session:e.session}),(0,m.jsx)(C,{initialColorHex:j.colors.bad,colorHex:j.colors.veryBad,metrics:e.metrics.filter((function(e){return"negative"===e.category})),updateScore:e.updateScore,session:e.session})]}):(0,m.jsx)(y.default,{style:{fontSize:20},children:"Click 'Add Metrics' below to get started! "}),(0,m.jsx)(y.default,{children:"\n"})]})}var I=r(6591);function _(e){var t=e.session,r=e.triggerMetricCallToggle,o=(0,l.useState)(!1),a=(0,n.default)(o,2),s=a[0],u=a[1],f=(0,l.useState)("New positive metric"),g=(0,n.default)(f,2),p=g[0],h=g[1],x=(0,l.useState)(""),j=(0,n.default)(x,2),S=j[0],C=j[1],w=(0,l.useState)("New negative metric"),_=(0,n.default)(w,2),O=_[0],P=_[1],H=(0,l.useState)(""),M=(0,n.default)(H,2),z=M[0],k=M[1];function B(e,t){return D.apply(this,arguments)}function D(){return(D=(0,d.default)((function*(e,n){try{console.log("async insertMetric called with:"),console.log({name:e,category:n}),u(!0);var o={user:t.user.id,name:e,category:n},a=(yield c.from("metrics").insert(o)).error;if(a)throw a}catch(a){a instanceof Error&&b(a.message)}finally{u(!1),r()}}))).apply(this,arguments)}return(0,m.jsxs)(i.default,{children:[(0,m.jsx)(I.default,{style:T.input,onChangeText:h,value:p}),(0,m.jsx)(v.default,{title:"Add positive metric",onPress:function(){return function(e){C(e),B(e,"positive")}(p)},disabled:s}),(0,m.jsx)(y.default,{children:S?`added ${S}!`:""}),(0,m.jsx)(y.default,{children:"\n\n"}),(0,m.jsx)(I.default,{style:T.input,onChangeText:P,value:O}),(0,m.jsx)(v.default,{title:"Add negative metric",onPress:function(){return function(e){k(e),B(e,"negative")}(O)},disabled:s}),(0,m.jsx)(y.default,{children:z?`added ${z}!`:""}),(0,m.jsx)(y.default,{children:"\n\n"})]})}var T=a.default.create({input:{height:40,margin:12,borderWidth:1,padding:10}}),O=r(2982),P=r(5087);function H(e){var t=(0,l.useState)(e.metrics),r=(0,n.default)(t,2),o=r[0],a=r[1],s=(0,l.useState)(!0),u=(0,n.default)(s,2),f=u[0],g=u[1];function p(){return(p=(0,d.default)((function*(){var t=o.filter((function(e){return!0===e.staged_to_delete})).map((function(e){return e.name}));(yield c.from("metrics").delete().eq("user",e.session.user.id).in("name",t)).error;b("Deletion submitted, return to home page to see remaining metrics."),e.triggerMetricCallToggle()}))).apply(this,arguments)}return(0,m.jsxs)(i.default,{style:{flex:1,padding:20,justifyContent:"center",alignItems:"center"},children:[(0,m.jsx)(y.default,{style:{fontSize:18,fontWeight:"bold"},children:"Delete Metrics"}),(0,m.jsx)(y.default,{children:"\n"}),(0,m.jsx)(x.default,{data:o,renderItem:function(e){var t=e.item;return(0,m.jsxs)(i.default,{style:{flex:1,flexDirection:"row",padding:10},children:[(0,m.jsx)(P.default,{trackColor:{false:"#767577",true:"#81b0ff"},thumbColor:t.a?"#f5dd4b":"#f4f3f4",ios_backgroundColor:"#3e3e3e",onValueChange:function(){return function(e){var t=(0,O.default)(o);for(var r of t)r.name===e.name&&(r.staged_to_delete=!r.staged_to_delete);g(t.filter((function(e){return!0===e.staged_to_delete})).length<=0),a(t)}(t)},value:t.staged_to_delete}),(0,m.jsx)(y.default,{style:{padding:10},children:t.name})]})}}),(0,m.jsx)(v.default,{title:"Delete",onPress:function(){return b("Delete all selected?","Press OK to permanently delete metrics.",[{text:"Cancel",onPress:function(){return console.log("Cancel Pressed")},style:"cancel"},{text:"OK",onPress:function(){return function(){return p.apply(this,arguments)}()}}])},disabled:f})]})}var M=r(5382),z=r(9986),k=(0,M.default)();function B(e){return e.metrics.forEach((function(t){t.staged_to_delete=!1,t.lifetimeCount=e.metricLogs.filter((function(e){return e.metric_id===t.id})).length,t.todayCount=e.todayLogs.filter((function(e){return e.metric_id===t.id})).length})),(0,m.jsx)(i.default,{style:{flex:1,minWidth:"100vw",justifyContent:"center"},children:(0,m.jsxs)(k.Navigator,{initialRouteName:"HomePage",screenOptions:{tabBarActiveTintColor:"#e91e63"},children:[(0,m.jsx)(k.Screen,{name:"Home",component:function(){return(0,m.jsx)(w,{lifetimeScore:e.lifetimeScore,todayScore:e.todayScore,updateScore:e.updateScore,metrics:e.metrics,session:e.session,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Home",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(z.default,{name:"home",color:t,size:r})}}}),(0,m.jsx)(k.Screen,{name:"Add",component:function(){return(0,m.jsx)(_,{session:e.session,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Add",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(z.default,{name:"plus",color:t,size:r})}}}),(0,m.jsx)(k.Screen,{name:"Delete",component:function(){return(0,m.jsx)(H,{session:e.session,metrics:e.metrics,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Delete",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(z.default,{name:"trash-can-outline",color:t,size:r})}}})]})})}function D(e){var t=e.session,r=(0,l.useState)(0),o=(0,n.default)(r,2),a=o[0],i=o[1],s=(0,l.useState)(0),u=(0,n.default)(s,2),f=u[0],g=u[1],p=(0,l.useState)(!1),h=(0,n.default)(p,2),x=h[0],j=h[1],v=(0,l.useState)(!1),S=(0,n.default)(v,2),C=S[0],w=S[1],I=(0,l.useState)(!1),_=(0,n.default)(I,2),T=_[0],O=_[1],P=(0,l.useState)([]),H=(0,n.default)(P,2),M=H[0],z=H[1],k=(0,l.useState)([]),D=(0,n.default)(k,2),F=D[0],E=D[1],W=(0,l.useState)([]),A=(0,n.default)(W,2),L=A[0],J=A[1];function N(){j(!x)}function q(){return(q=(0,d.default)((function*(){try{w(!0);var e=yield c.from("metrics").select("id,name,category").eq("user",t.user.id),r=e.data,n=e.error,o=e.status;if(n&&406!==o)throw n;r&&z(r)}catch(n){n instanceof Error&&b(n.message)}finally{w(!1)}}))).apply(this,arguments)}function G(){return(G=(0,d.default)((function*(){var e=new Date;e.setHours(0,0,0,0);var r=new Date;r.setHours(23,59,59,999);try{O(!0);var n=yield c.from("metric_logs").select("id,created_at,user_id,metric_id").eq("user_id",t.user.id),o=n.data,a=n.error,l=n.status;if(a&&406!==l)throw a;if(o){E(o),i(o.length);var s=o.filter((function(t){return new Date(t.created_at)>=e&&new Date(t.created_at)<=r}));J(s),g(L.length)}}catch(a){a instanceof Error&&b(a.message)}finally{O(!1)}}))).apply(this,arguments)}return(0,l.useEffect)((function(){!function(){q.apply(this,arguments)}(),function(){G.apply(this,arguments)}()}),[x]),C||T?(0,m.jsx)(y.default,{children:"Loading..."}):(0,m.jsx)(B,{lifetimeScore:a,todayScore:f,updateScore:function(e){g(f+e),i(a+e),N()},triggerMetricCallToggle:N,metrics:M,metricLogs:F,todayLogs:L,session:t})}function F(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(y.default,{style:{fontSize:20,fontWeight:"bold"},children:["Accountable","\n"]}),(0,m.jsxs)(y.default,{style:{fontSize:14},children:["The actions you take create the person you're becoming.","\n"]})]})}function E(){var e=(0,l.useState)(null),t=(0,n.default)(e,2),r=t[0],a=t[1];return(0,l.useEffect)((function(){c.auth.getSession().then((function(e){var t=e.data.session;a(t)})),c.auth.onAuthStateChange((function(e,t){a(t)}))}),[]),(0,m.jsx)(i.default,{style:W.container,children:(0,m.jsxs)(s.default,{children:[(0,m.jsx)(F,{}),(0,m.jsx)(o.default,{style:"auto"}),(0,m.jsx)(i.default,{style:{flex:6,alignItems:"center",justifyContent:"center"},children:r&&r.user?(0,m.jsx)(D,{session:r},r.user.id):(0,m.jsx)(p,{})})]})})}var W=a.default.create({container:{padding:30,flex:1,backgroundColor:j.colors.background,alignItems:"center",justifyContent:"space-between",maxHeight:"100vh"}})}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.loaded=!0,a.exports}r.m=e,(()=>{var e=[];r.O=(t,n,o,a)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,o,a]=e[c],l=!0,s=0;s<n.length;s++)(!1&a||i>=a)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(l=!1,a<i&&(i=a));if(l){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[n,o,a]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"===typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"===typeof n.then)return n}var a=Object.create(null);r.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&o&&n;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,r.d(a,i),a}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="/accountable/",(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var o,a,[i,l,s]=n,u=0;if(i.some((t=>0!==e[t]))){for(o in l)r.o(l,o)&&(r.m[o]=l[o]);if(s)var c=s(r)}for(t&&t(n);u<i.length;u++)a=i[u],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=r.O(void 0,[125],(()=>r(6271)));n=r.O(n)})();
//# sourceMappingURL=main.d8aef892.js.map