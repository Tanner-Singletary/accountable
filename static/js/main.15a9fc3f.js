(()=>{"use strict";var e={8097:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var r=n(885),o=n(3426),a=n(6792),i=n(9385),s=(n(5682),n(5004)),l=n(5705),u=n(519),c=(0,n(1218).createClient)("https://bxfruloupumcvynxnqnt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4ZnJ1bG91cHVtY3Z5bnhucW50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTgwMTUyNzIsImV4cCI6MjAxMzU5MTI3Mn0.m6EPHp4wxq7GdWTJjjrdDQaD8uH2oWRWr1Sas4cwq1k",{auth:{storage:u.default,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),d=n(5861),f=n(3624),m=n(6850),p=n(2629);function h(){var e=(0,s.useState)(""),t=(0,r.default)(e,2),n=t[0],o=t[1],a=(0,s.useState)(""),l=(0,r.default)(a,2),u=l[0],h=l[1],g=(0,s.useState)(!1),x=(0,r.default)(g,2),v=x[0],j=x[1];function b(){return(b=(0,d.default)((function*(){j(!0);var e=(yield c.auth.signInWithPassword({email:n,password:u})).error;e&&f.default.alert(e.message),j(!1)}))).apply(this,arguments)}function S(){return(S=(0,d.default)((function*(){j(!0);var e=(yield c.auth.signUp({email:n,password:u})).error;e&&f.default.alert(e.message),j(!1)}))).apply(this,arguments)}return(0,p.jsxs)(i.default,{style:y.container,children:[(0,p.jsx)(i.default,{style:[y.verticallySpaced,y.mt20],children:(0,p.jsx)(m.Input,{label:"Email",leftIcon:{type:"font-awesome",name:"envelope"},onChangeText:function(e){return o(e)},value:n,placeholder:"email@address.com",autoCapitalize:"none"})}),(0,p.jsx)(i.default,{style:y.verticallySpaced,children:(0,p.jsx)(m.Input,{label:"Password",leftIcon:{type:"font-awesome",name:"lock"},onChangeText:function(e){return h(e)},value:u,secureTextEntry:!0,placeholder:"Password",autoCapitalize:"none"})}),(0,p.jsx)(i.default,{style:[y.verticallySpaced,y.mt20],children:(0,p.jsx)(m.Button,{title:"Sign in",disabled:v,onPress:function(){return function(){return b.apply(this,arguments)}()}})}),(0,p.jsx)(i.default,{style:y.verticallySpaced,children:(0,p.jsx)(m.Button,{title:"Sign up",disabled:v,onPress:function(){return function(){return S.apply(this,arguments)}()}})})]})}var y=a.default.create({container:{marginTop:40,padding:12},verticallySpaced:{paddingTop:4,paddingBottom:4,alignSelf:"stretch"},mt20:{marginTop:20}}),g=n(1054),x=n(3645),v={colors:{background:"#F6F6F6",foreground:"#202121",primary:"#FFFFFFFF",veryGood:"#53C623",good:"#BDEDA8",veryBad:"#FF5733",bad:"#EDB9A8"},spacing:{s:8,m:16,l:24},textVariants:{header:{fontSize:36,fontWeight:"bold"},body:{fontSize:16}}},j=n(3693);const b="web"===n(2152).default.OS?function(e,t,n,r){if(window.confirm([e,t].filter(Boolean).join("\n"))){var o=n.find((function(e){return"cancel"!==e.style}));o&&o.onPress()}else{var a=n.find((function(e){return"cancel"===e.style}));a&&a.onPress()}}:f.default.alert;function S(e){var t=(0,s.useState)(!1),n=(0,r.default)(t,2),o=n[0],a=n[1],l=(0,s.useState)(Boolean(e.metric.todayCount)),u=(0,r.default)(l,2),f=u[0],m=u[1],h=(0,s.useState)(e.metric.todayCount),y=(0,r.default)(h,2),x=y[0],S=y[1],C=(0,s.useState)(e.metric.lifetimeCount),w=(0,r.default)(C,2),_=w[0],I=w[1];function O(){return(O=(0,d.default)((function*(){m(!0),S(x+1),I(_+1);var t=e.colorHex===v.colors.veryBad?-1:1;e.updateScore(t);try{a(!0);var n={user_id:e.session.user.id,metric_id:e.metric.id},r=(yield c.from("metric_logs").insert(n)).error;if(r)throw r}catch(r){r instanceof Error&&b(r.message)}finally{a(!1)}}))).apply(this,arguments)}return(0,p.jsxs)(i.default,{style:{flex:1,alignItems:"center",justifyContent:"center",margin:10,backgroundColor:f?e.colorHex:e.initialColorHex,borderColor:"black",borderWidth:1},children:[(0,p.jsx)(j.default,{title:e.metric.name,onPress:function(){return function(){return O.apply(this,arguments)}()},disabled:o}),(0,p.jsxs)(g.default,{children:["Lifetime: ",_]}),(0,p.jsxs)(g.default,{children:["Today: ",x]})]})}function C(e){var t=e.colorHex===v.colors.veryBad?"Don't":"Do";return(0,p.jsxs)(i.default,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:[(0,p.jsx)(g.default,{style:{fontSize:18,fontWeight:"bold"},children:t}),(0,p.jsx)(x.default,{style:{backgroundColor:e.initialColorHex},data:e.metrics,renderItem:function(t){var n=t.item;return(0,p.jsx)(S,{metric:n,initialColorHex:e.initialColorHex,colorHex:e.colorHex,updateScore:e.updateScore,session:e.session})}})]})}function w(e){return(0,p.jsxs)(i.default,{style:{flex:1,marginTop:10,alignItems:"center",justifyContent:"center"},children:[(0,p.jsxs)(g.default,{children:["Lifetime Score: ",e.lifetimeScore]}),(0,p.jsxs)(g.default,{children:["Today's Score: ",e.todayScore]}),e.metrics.length>0?(0,p.jsxs)(i.default,{style:{flex:1,flexDirection:"row",padding:10,alignItems:"center",justifyContent:"center"},children:[(0,p.jsx)(C,{initialColorHex:v.colors.good,colorHex:v.colors.veryGood,metrics:e.metrics.filter((function(e){return"positive"===e.category})),updateScore:e.updateScore,session:e.session}),(0,p.jsx)(C,{initialColorHex:v.colors.bad,colorHex:v.colors.veryBad,metrics:e.metrics.filter((function(e){return"negative"===e.category})),updateScore:e.updateScore,session:e.session})]}):(0,p.jsx)(g.default,{style:{fontSize:20},children:"Click 'Add Metrics' below to get started! "}),(0,p.jsx)(g.default,{children:"\n"})]})}var _=n(6591);function I(e){var t=e.session,n=(0,s.useState)(!1),o=(0,r.default)(n,2),a=o[0],l=o[1],u=(0,s.useState)("New positive metric"),f=(0,r.default)(u,2),m=f[0],h=f[1],y=(0,s.useState)(""),x=(0,r.default)(y,2),v=x[0],S=x[1],C=(0,s.useState)("New negative metric"),w=(0,r.default)(C,2),I=w[0],P=w[1],T=(0,s.useState)(""),B=(0,r.default)(T,2),H=B[0],z=B[1];function k(e,t){return D.apply(this,arguments)}function D(){return(D=(0,d.default)((function*(e,n){try{console.log("async insertMetric called with:"),console.log({name:e,category:n}),l(!0);var r={user:t.user.id,name:e,category:n},o=(yield c.from("metrics").insert(r)).error;if(o)throw o}catch(o){o instanceof Error&&b(o.message)}finally{l(!1)}}))).apply(this,arguments)}return(0,p.jsxs)(i.default,{children:[(0,p.jsx)(_.default,{style:O.input,onChangeText:h,value:m}),(0,p.jsx)(j.default,{title:"Add positive metric",onPress:function(){return function(e){S(e),k(e,"positive")}(m)},disabled:a}),(0,p.jsx)(g.default,{children:v?`added ${v}!`:""}),(0,p.jsx)(g.default,{children:"\n\n"}),(0,p.jsx)(_.default,{style:O.input,onChangeText:P,value:I}),(0,p.jsx)(j.default,{title:"Add negative metric",onPress:function(){return function(e){z(e),k(e,"negative")}(I)},disabled:a}),(0,p.jsx)(g.default,{children:H?`added ${H}!`:""}),(0,p.jsx)(g.default,{children:"\n\n"})]})}var O=a.default.create({input:{height:40,margin:12,borderWidth:1,padding:10}}),P=n(2982),T=n(5087);function B(e){var t=(0,s.useState)(e.metrics),n=(0,r.default)(t,2),o=n[0],a=n[1],l=(0,s.useState)(!0),u=(0,r.default)(l,2),f=u[0],m=u[1];function h(){return(h=(0,d.default)((function*(){var t=o.filter((function(e){return!0===e.staged_to_delete})).map((function(e){return e.name}));(yield c.from("metrics").delete().eq("user",e.session.user.id).in("name",t)).error;b("Deletion submitted, return to home page to see remaining metrics."),e.setActivePage("home")}))).apply(this,arguments)}return(0,p.jsxs)(i.default,{style:{flex:1,padding:20,justifyContent:"center",alignItems:"center"},children:[(0,p.jsx)(g.default,{style:{fontSize:18,fontWeight:"bold"},children:"Delete Metrics"}),(0,p.jsx)(g.default,{children:"\n"}),(0,p.jsx)(x.default,{data:o,renderItem:function(e){var t=e.item;return(0,p.jsxs)(i.default,{style:{flex:1,flexDirection:"row",padding:10},children:[(0,p.jsx)(T.default,{trackColor:{false:"#767577",true:"#81b0ff"},thumbColor:t.a?"#f5dd4b":"#f4f3f4",ios_backgroundColor:"#3e3e3e",onValueChange:function(){return function(e){var t=(0,P.default)(o);for(var n of t)n.name===e.name&&(n.staged_to_delete=!n.staged_to_delete);m(t.filter((function(e){return!0===e.staged_to_delete})).length<=0),a(t)}(t)},value:t.staged_to_delete}),(0,p.jsx)(g.default,{style:{padding:10},children:t.name})]})}}),(0,p.jsx)(j.default,{title:"Delete",onPress:function(){return b("Delete all selected?","Press OK to permanently delete metrics.",[{text:"Cancel",onPress:function(){return console.log("Cancel Pressed")},style:"cancel"},{text:"OK",onPress:function(){return function(){return h.apply(this,arguments)}()}}])},disabled:f})]})}var H=n(5382),z=n(9986),k=(0,H.default)();function D(e){return e.metrics.forEach((function(t){t.staged_to_delete=!1,t.lifetimeCount=e.metricLogs.filter((function(e){return e.metric_id===t.id})).length,t.todayCount=e.todayLogs.filter((function(e){return e.metric_id===t.id})).length})),(0,p.jsx)(i.default,{style:{flex:1,minWidth:300},children:(0,p.jsxs)(k.Navigator,{initialRouteName:"HomePage",screenOptions:{tabBarActiveTintColor:"#e91e63"},children:[(0,p.jsx)(k.Screen,{name:"Home",component:function(){return(0,p.jsx)(w,{lifetimeScore:e.lifetimeScore,todayScore:e.todayScore,updateScore:e.updateScore,metrics:e.metrics,session:e.session})},options:{tabBarLabel:"Home",tabBarIcon:function(e){var t=e.color,n=e.size;return(0,p.jsx)(z.default,{name:"home",color:t,size:n})}}}),(0,p.jsx)(k.Screen,{name:"Add",component:function(){return(0,p.jsx)(I,{session:e.session})},options:{tabBarLabel:"Add",tabBarIcon:function(e){var t=e.color,n=e.size;return(0,p.jsx)(z.default,{name:"plus",color:t,size:n})},tabBarBadge:3}}),(0,p.jsx)(k.Screen,{name:"Delete",component:function(){return(0,p.jsx)(B,{session:e.session,metrics:e.metrics,setActivePage:e.setActivePage})},options:{tabBarLabel:"Delete",tabBarIcon:function(e){var t=e.color,n=e.size;return(0,p.jsx)(z.default,{name:"trash-can-outline",color:t,size:n})}}})]})})}function F(e){var t=e.session,n=(0,s.useState)(0),o=(0,r.default)(n,2),a=o[0],i=o[1],l=(0,s.useState)(0),u=(0,r.default)(l,2),f=u[0],m=u[1],h=(0,s.useState)("home"),y=(0,r.default)(h,2),x=y[0],v=y[1],j=(0,s.useState)(!1),S=(0,r.default)(j,2),C=S[0],w=S[1],_=(0,s.useState)(!1),I=(0,r.default)(_,2),O=I[0],P=I[1],T=(0,s.useState)([]),B=(0,r.default)(T,2),H=B[0],z=B[1],k=(0,s.useState)([]),F=(0,r.default)(k,2),A=F[0],E=F[1],M=(0,s.useState)([]),W=(0,r.default)(M,2),L=W[0],J=W[1];function N(){return(N=(0,d.default)((function*(){try{w(!0);var e=yield c.from("metrics").select("id,name,category").eq("user",t.user.id),n=e.data,r=e.error,o=e.status;if(r&&406!==o)throw r;n&&z(n)}catch(r){r instanceof Error&&b(r.message)}finally{w(!1)}}))).apply(this,arguments)}function q(){return(q=(0,d.default)((function*(){var e=new Date;e.setHours(0,0,0,0);var n=new Date;n.setHours(23,59,59,999);try{P(!0);var r=yield c.from("metric_logs").select("id,created_at,user_id,metric_id").eq("user_id",t.user.id),o=r.data,a=r.error,s=r.status;if(a&&406!==s)throw a;if(o){E(o),i(o.length);var l=o.filter((function(t){return new Date(t.created_at)>=e&&new Date(t.created_at)<=n}));J(l),m(L.length)}}catch(a){a instanceof Error&&b(a.message)}finally{P(!1)}}))).apply(this,arguments)}return(0,s.useEffect)((function(){!function(){N.apply(this,arguments)}(),function(){q.apply(this,arguments)}()}),[x]),C||O?(0,p.jsx)(g.default,{children:"Loading..."}):(0,p.jsx)(D,{lifetimeScore:a,todayScore:f,updateScore:function(e){m(f+e),i(a+e)},activePage:x,setActivePage:v,metrics:H,metricLogs:A,todayLogs:L,session:t})}function A(){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(g.default,{style:{fontSize:20,fontWeight:"bold"},children:["Accountable","\n"]}),(0,p.jsxs)(g.default,{style:{fontSize:14},children:["The actions you take create the person you're becoming.","\n"]})]})}function E(){var e=(0,s.useState)(null),t=(0,r.default)(e,2),n=t[0],a=t[1];return(0,s.useEffect)((function(){c.auth.getSession().then((function(e){var t=e.data.session;a(t)})),c.auth.onAuthStateChange((function(e,t){a(t)}))}),[]),(0,p.jsx)(i.default,{style:M.container,children:(0,p.jsxs)(l.default,{children:[(0,p.jsx)(A,{}),n&&n.user?(0,p.jsx)(F,{session:n},n.user.id):(0,p.jsx)(h,{}),(0,p.jsx)(o.default,{style:"auto"})]})})}var M=a.default.create({container:{padding:30,flex:1,backgroundColor:v.colors.background,alignItems:"center",justifyContent:"center"}})}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,(()=>{var e=[];n.O=(t,r,o,a)=>{if(!r){var i=1/0;for(c=0;c<e.length;c++){for(var[r,o,a]=e[c],s=!0,l=0;l<r.length;l++)(!1&a||i>=a)&&Object.keys(n.O).every((e=>n.O[e](r[l])))?r.splice(l--,1):(s=!1,a<i&&(i=a));if(s){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,o,a]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/accountable/",(()=>{var e={179:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var o,a,[i,s,l]=r,u=0;if(i.some((t=>0!==e[t]))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)var c=l(n)}for(t&&t(r);u<i.length;u++)a=i[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(c)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[125],(()=>n(6271)));r=n.O(r)})();
//# sourceMappingURL=main.15a9fc3f.js.map