(()=>{"use strict";var e={8620:(e,t,r)=>{r.r(t),r.d(t,{default:()=>L});var n=r(885),i=r(3426),o=r(6792),a=r(9385),l=(r(5682),r(5004)),s=r(5705),u=r(519),c=(0,r(1218).createClient)("https://bxfruloupumcvynxnqnt.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ4ZnJ1bG91cHVtY3Z5bnhucW50Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2OTgwMTUyNzIsImV4cCI6MjAxMzU5MTI3Mn0.m6EPHp4wxq7GdWTJjjrdDQaD8uH2oWRWr1Sas4cwq1k",{auth:{storage:u.default,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1}}),d=r(5861),f=r(3624),g=r(6850),m=r(2629);function h(){var e=(0,l.useState)(""),t=(0,n.default)(e,2),r=t[0],i=t[1],o=(0,l.useState)(""),s=(0,n.default)(o,2),u=s[0],h=s[1],p=(0,l.useState)(!1),x=(0,n.default)(p,2),j=x[0],v=x[1];function b(){return(b=(0,d.default)((function*(){v(!0);var e=(yield c.auth.signInWithPassword({email:r,password:u})).error;e&&f.default.alert(e.message),v(!1)}))).apply(this,arguments)}function S(){return(S=(0,d.default)((function*(){v(!0);var e=(yield c.auth.signUp({email:r,password:u})).error;e&&f.default.alert(e.message),v(!1)}))).apply(this,arguments)}return(0,m.jsxs)(a.default,{style:y.container,children:[(0,m.jsx)(a.default,{style:[y.verticallySpaced,y.mt20],children:(0,m.jsx)(g.Input,{label:"Email",leftIcon:{type:"font-awesome",name:"envelope"},onChangeText:function(e){return i(e)},value:r,placeholder:"email@address.com",autoCapitalize:"none"})}),(0,m.jsx)(a.default,{style:y.verticallySpaced,children:(0,m.jsx)(g.Input,{label:"Password",leftIcon:{type:"font-awesome",name:"lock"},onChangeText:function(e){return h(e)},value:u,secureTextEntry:!0,placeholder:"Password",autoCapitalize:"none"})}),(0,m.jsx)(a.default,{style:[y.verticallySpaced,y.mt20],children:(0,m.jsx)(g.Button,{title:"Sign in",disabled:j,onPress:function(){return function(){return b.apply(this,arguments)}()}})}),(0,m.jsx)(a.default,{style:y.verticallySpaced,children:(0,m.jsx)(g.Button,{title:"Sign up",disabled:j,onPress:function(){return function(){return S.apply(this,arguments)}()}})})]})}var y=o.default.create({container:{marginTop:40,padding:12},verticallySpaced:{paddingTop:4,paddingBottom:4,alignSelf:"stretch"},mt20:{marginTop:20}}),p=r(1054),x=r(3645),j={colors:{background:"#F6F6F6",foreground:"#202121",primary:"#FFFFFFFF",veryGood:"#53C623",good:"#BDEDA8",veryBad:"#FF5733",bad:"#EDB9A8"},spacing:{s:8,m:16,l:24},textVariants:{header:{fontSize:36,fontWeight:"bold"},body:{fontSize:16}}},v=r(3693);const b="web"===r(2152).default.OS?function(e,t,r,n){if(window.confirm([e,t].filter(Boolean).join("\n"))){var i=r.find((function(e){return"cancel"!==e.style}));i&&i.onPress()}else{var o=r.find((function(e){return"cancel"===e.style}));o&&o.onPress()}}:f.default.alert;function S(e){var t=(0,l.useState)(!1),r=(0,n.default)(t,2),i=r[0],o=r[1],s=(0,l.useState)(Boolean(e.metric.todayCount)),u=(0,n.default)(s,2),f=u[0],g=u[1],h=(0,l.useState)(e.metric.todayCount),y=(0,n.default)(h,2),x=y[0],j=y[1],S=(0,l.useState)(e.metric.lifetimeCount),C=(0,n.default)(S,2),w=C[0],I=C[1];function _(){return(_=(0,d.default)((function*(){g(!0),j(x+1),I(w+1);try{o(!0);var t={user_id:e.session.user.id,metric_id:e.metric.id},r=(yield c.from("metric_logs").insert(t)).error;if(r)throw r}catch(r){r instanceof Error&&b(r.message)}finally{o(!1)}}))).apply(this,arguments)}return(0,m.jsxs)(a.default,{style:{flex:1,alignItems:"center",justifyContent:"center",margin:10,backgroundColor:f?e.colorHex:e.initialColorHex,borderColor:"black",borderWidth:1},children:[(0,m.jsx)(v.default,{title:e.metric.name,onPress:function(){return function(){return _.apply(this,arguments)}()},disabled:i}),(0,m.jsxs)(p.default,{children:["Lifetime: ",w]}),(0,m.jsxs)(p.default,{children:["Today: ",x]})]})}function C(e){var t=e.colorHex===j.colors.veryBad?"Don't":"Do";return(0,m.jsxs)(a.default,{style:{flex:1,alignItems:"center",justifyContent:"center",overflowY:"auto",maxHeight:"100%"},children:[(0,m.jsx)(p.default,{style:{fontSize:18,fontWeight:"bold"},children:t}),(0,m.jsx)(x.default,{style:{backgroundColor:e.initialColorHex},data:e.metrics,renderItem:function(t){var r=t.item;return(0,m.jsx)(S,{metric:r,initialColorHex:e.initialColorHex,colorHex:e.colorHex,session:e.session})}})]})}function w(e){return(0,m.jsxs)(a.default,{style:{flex:1,marginTop:10,alignItems:"center",justifyContent:"center"},children:[e.metrics.length>0?(0,m.jsxs)(a.default,{style:{flex:1,flexDirection:"row",padding:10,alignItems:"center",justifyContent:"center"},children:[(0,m.jsx)(C,{initialColorHex:j.colors.good,colorHex:j.colors.veryGood,metrics:e.metrics.filter((function(e){return"positive"===e.category})),session:e.session}),(0,m.jsx)(C,{initialColorHex:j.colors.bad,colorHex:j.colors.veryBad,metrics:e.metrics.filter((function(e){return"negative"===e.category})),session:e.session})]}):(0,m.jsx)(p.default,{style:{fontSize:20},children:"Click 'Add' below to get started! "}),(0,m.jsx)(p.default,{children:"\n"})]})}function I(e){return(0,m.jsxs)(a.default,{style:{flex:1,padding:30,alignItems:"center",justifyContent:"center"},children:[(0,m.jsxs)(p.default,{children:["Lifetime Score: ",e.lifetimeScore]}),(0,m.jsxs)(p.default,{children:["Today's Score: ",e.todayScore]}),(0,m.jsxs)(p.default,{children:["\n\n","Click to refresh scores"]}),(0,m.jsxs)(p.default,{children:["(returns you to home page)","\n\n"]}),(0,m.jsx)(v.default,{title:"Refresh",onPress:function(){return e.triggerMetricCallToggle()}})]})}var _=r(6591);function T(e){var t=e.session,r=e.triggerMetricCallToggle,i=(0,l.useState)(!1),o=(0,n.default)(i,2),s=o[0],u=o[1],f=(0,l.useState)("New positive metric"),g=(0,n.default)(f,2),h=g[0],y=g[1],x=(0,l.useState)(""),j=(0,n.default)(x,2),S=j[0],C=j[1],w=(0,l.useState)("New negative metric"),I=(0,n.default)(w,2),T=I[0],P=I[1],M=(0,l.useState)(""),z=(0,n.default)(M,2),H=z[0],k=z[1];function B(e,t){return D.apply(this,arguments)}function D(){return(D=(0,d.default)((function*(e,n){try{console.log("async insertMetric called with:"),console.log({name:e,category:n}),u(!0);var i={user:t.user.id,name:e,category:n},o=(yield c.from("metrics").insert(i)).error;if(o)throw o}catch(o){o instanceof Error&&b(o.message)}finally{u(!1),r()}}))).apply(this,arguments)}return(0,m.jsxs)(a.default,{children:[(0,m.jsx)(_.default,{style:O.input,onChangeText:y,value:h}),(0,m.jsx)(v.default,{title:"Add positive metric",onPress:function(){return function(e){C(e),B(e,"positive")}(h)},disabled:s}),(0,m.jsx)(p.default,{children:S?`added ${S}!`:""}),(0,m.jsx)(p.default,{children:"\n\n"}),(0,m.jsx)(_.default,{style:O.input,onChangeText:P,value:T}),(0,m.jsx)(v.default,{title:"Add negative metric",onPress:function(){return function(e){k(e),B(e,"negative")}(T)},disabled:s}),(0,m.jsx)(p.default,{children:H?`added ${H}!`:""}),(0,m.jsx)(p.default,{children:"\n\n"})]})}var O=o.default.create({input:{height:40,margin:12,borderWidth:1,padding:10}}),P=r(2982),M=r(5087);function z(e){var t=(0,l.useState)(e.metrics),r=(0,n.default)(t,2),i=r[0],o=r[1],s=(0,l.useState)(!0),u=(0,n.default)(s,2),f=u[0],g=u[1];function h(){return(h=(0,d.default)((function*(){var t=i.filter((function(e){return!0===e.staged_to_delete})).map((function(e){return e.name}));(yield c.from("metrics").delete().eq("user",e.session.user.id).in("name",t)).error;b("Deletion submitted, return to home page to see remaining metrics."),e.triggerMetricCallToggle()}))).apply(this,arguments)}return(0,m.jsxs)(a.default,{style:{flex:1,padding:20,justifyContent:"center",alignItems:"center"},children:[(0,m.jsx)(p.default,{style:{fontSize:18,fontWeight:"bold"},children:"Delete Metrics"}),(0,m.jsx)(p.default,{children:"\n"}),(0,m.jsx)(x.default,{data:i,renderItem:function(e){var t=e.item;return(0,m.jsxs)(a.default,{style:{flex:1,flexDirection:"row",padding:10},children:[(0,m.jsx)(M.default,{trackColor:{false:"#767577",true:"#81b0ff"},thumbColor:t.a?"#f5dd4b":"#f4f3f4",ios_backgroundColor:"#3e3e3e",onValueChange:function(){return function(e){var t=(0,P.default)(i);for(var r of t)r.name===e.name&&(r.staged_to_delete=!r.staged_to_delete);g(t.filter((function(e){return!0===e.staged_to_delete})).length<=0),o(t)}(t)},value:t.staged_to_delete}),(0,m.jsx)(p.default,{style:{padding:10},children:t.name})]})}}),(0,m.jsx)(v.default,{title:"Delete",onPress:function(){return b("Delete all selected?","Press OK to permanently delete metrics.",[{text:"Cancel",onPress:function(){return console.log("Cancel Pressed")},style:"cancel"},{text:"OK",onPress:function(){return function(){return h.apply(this,arguments)}()}}])},disabled:f})]})}var H=r(5382),k=r(9986),B=(0,H.default)();function D(e){return e.metrics.forEach((function(t){t.staged_to_delete=!1,t.lifetimeCount=e.metricLogs.filter((function(e){return e.metric_id===t.id})).length,t.todayCount=e.todayLogs.filter((function(e){return e.metric_id===t.id})).length})),(0,m.jsx)(a.default,{style:{flex:1,minWidth:"100vw",justifyContent:"center"},children:(0,m.jsxs)(B.Navigator,{initialRouteName:"HomePage",screenOptions:{tabBarActiveTintColor:"#e91e63"},children:[(0,m.jsx)(B.Screen,{name:"Home",component:function(){return(0,m.jsx)(w,{metrics:e.metrics,session:e.session,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Home",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(k.default,{name:"home",color:t,size:r})}}}),(0,m.jsx)(B.Screen,{name:"Profile",component:function(){return(0,m.jsx)(I,{lifetimeScore:e.lifetimeScore,todayScore:e.todayScore,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Profile",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(k.default,{name:"head-flash-outline",color:t,size:r})}}}),(0,m.jsx)(B.Screen,{name:"Add",component:function(){return(0,m.jsx)(T,{session:e.session,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Add",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(k.default,{name:"plus",color:t,size:r})}}}),(0,m.jsx)(B.Screen,{name:"Delete",component:function(){return(0,m.jsx)(z,{session:e.session,metrics:e.metrics,triggerMetricCallToggle:e.triggerMetricCallToggle})},options:{tabBarLabel:"Delete",tabBarIcon:function(e){var t=e.color,r=e.size;return(0,m.jsx)(k.default,{name:"trash-can-outline",color:t,size:r})}}})]})})}function F(e){var t=e.session,r=(0,l.useState)(0),i=(0,n.default)(r,2),o=i[0],a=i[1],s=(0,l.useState)(0),u=(0,n.default)(s,2),f=u[0],g=u[1],h=(0,l.useState)(!1),y=(0,n.default)(h,2),x=y[0],j=y[1],v=(0,l.useState)(!0),S=(0,n.default)(v,2),C=S[0],w=S[1],I=(0,l.useState)(!0),_=(0,n.default)(I,2),T=_[0],O=_[1],P=(0,l.useState)([]),M=(0,n.default)(P,2),z=M[0],H=M[1],k=(0,l.useState)([]),B=(0,n.default)(k,2),F=B[0],E=B[1],L=(0,l.useState)([]),W=(0,n.default)(L,2),A=W[0],J=W[1];function N(){return(N=(0,d.default)((function*(){try{w(!0);var e=yield c.from("metrics").select("id,name,category").eq("user",t.user.id),r=e.data,n=e.error,i=e.status;if(n&&406!==i)throw n;r&&H(r)}catch(n){n instanceof Error&&b(n.message)}finally{w(!1)}}))).apply(this,arguments)}function q(){return(q=(0,d.default)((function*(){var e=new Date;e.setHours(0,0,0,0);var r=new Date;r.setHours(23,59,59,999);try{O(!0);var n=yield c.from("metric_logs").select("id,created_at,user_id,metric_id").eq("user_id",t.user.id),i=n.data,o=n.error,l=n.status;if(o&&406!==l)throw o;if(i){E(i),g(i.length);var s=i.filter((function(t){return new Date(t.created_at)>=e&&new Date(t.created_at)<=r}));J(s),a(s.length)}}catch(o){o instanceof Error&&b(o.message)}finally{O(!1)}}))).apply(this,arguments)}return(0,l.useEffect)((function(){!function(){N.apply(this,arguments)}(),function(){q.apply(this,arguments)}()}),[x]),C||T?(0,m.jsx)(p.default,{children:"Loading..."}):(0,m.jsx)(D,{lifetimeScore:f,todayScore:o,triggerMetricCallToggle:function(){j(!x)},metrics:z,metricLogs:F,todayLogs:A,session:t})}function E(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(p.default,{style:{fontSize:20,fontWeight:"bold"},children:["Accountable","\n"]}),(0,m.jsxs)(p.default,{style:{fontSize:14},children:["The actions you take create the person you're becoming.","\n"]})]})}function L(){var e=(0,l.useState)(null),t=(0,n.default)(e,2),r=t[0],o=t[1];return(0,l.useEffect)((function(){c.auth.getSession().then((function(e){var t=e.data.session;o(t)})),c.auth.onAuthStateChange((function(e,t){o(t)}))}),[]),(0,m.jsx)(a.default,{style:W.container,children:(0,m.jsxs)(s.default,{children:[(0,m.jsx)(E,{}),(0,m.jsx)(i.default,{style:"auto"}),(0,m.jsx)(a.default,{style:{flex:6,alignItems:"center",justifyContent:"center"},children:r&&r.user?(0,m.jsx)(F,{session:r},r.user.id):(0,m.jsx)(h,{})})]})})}var W=o.default.create({container:{padding:30,flex:1,backgroundColor:j.colors.background,alignItems:"center",justifyContent:"space-between",maxHeight:"100vh"}})}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.m=e,(()=>{var e=[];r.O=(t,n,i,o)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,i,o]=e[c],l=!0,s=0;s<n.length;s++)(!1&o||a>=o)&&Object.keys(r.O).every((e=>r.O[e](n[s])))?n.splice(s--,1):(l=!1,o<a&&(a=o));if(l){e.splice(c--,1);var u=i();void 0!==u&&(t=u)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,i,o]}})(),r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var o=Object.create(null);r.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var l=2&i&&n;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,r.d(o,a),o}})(),r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="/accountable/",(()=>{var e={179:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[a,l,s]=n,u=0;if(a.some((t=>0!==e[t]))){for(i in l)r.o(l,i)&&(r.m[i]=l[i]);if(s)var c=s(r)}for(t&&t(n);u<a.length;u++)o=a[u],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},n=self.webpackChunkweb=self.webpackChunkweb||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=r.O(void 0,[125],(()=>r(6271)));n=r.O(n)})();
//# sourceMappingURL=main.021528bd.js.map